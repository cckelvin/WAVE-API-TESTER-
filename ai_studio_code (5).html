<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wave Studio - API Tester</title>
    <style>
        :root {
            /* Light Theme (Default) */
            --bg: #ffffff;
            --bg-sec: #f4f4f5;
            --text: #09090b;
            --text-muted: #71717a;
            --border: #e4e4e7;
            --primary: #000000;
            --primary-fg: #ffffff;
            --accent: #3b82f6;
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
            --nav-height: 70px;
        }

        [data-theme="dark"] {
            --bg: #000000;
            --bg-sec: #18181b;
            --text: #fafafa;
            --text-muted: #a1a1aa;
            --border: #27272a;
            --primary: #ffffff;
            --primary-fg: #000000;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', system-ui, sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body { background-color: var(--bg); color: var(--text); height: 100vh; overflow: hidden; display: flex; flex-direction: column; transition: background 0.3s, color 0.3s; }

        /* --- SPLASH SCREEN --- */
        #splash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg); z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.6s ease;
        }
        .wave-logo { font-size: 2.5rem; font-weight: 800; letter-spacing: -1px; margin-bottom: 10px; }
        .wave-anim { width: 50px; height: 4px; background: var(--text); border-radius: 2px; animation: wave 1s infinite ease-in-out; }
        @keyframes wave { 0%, 100% { width: 10px; opacity: 0.5; } 50% { width: 50px; opacity: 1; } }

        /* --- LAYOUT --- */
        .app-container { flex: 1; position: relative; overflow: hidden; }
        
        /* Sections */
        .section {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            overflow-y: auto; padding: 20px 20px 100px 20px;
            display: none; opacity: 0; transition: opacity 0.3s;
            scrollbar-width: none; /* Hide scrollbar Firefox */
        }
        .section::-webkit-scrollbar { display: none; /* Hide scrollbar Chrome */ }
        .section.active { display: block; opacity: 1; }

        /* Typography */
        h1 { font-size: 1.8rem; font-weight: 700; margin-bottom: 5px; }
        h2 { font-size: 1.2rem; font-weight: 600; margin-bottom: 15px; }
        p { color: var(--text-muted); font-size: 0.9rem; margin-bottom: 20px; line-height: 1.5; }

        /* --- TESTER TAB --- */
        .search-bar {
            width: 100%; padding: 15px; background: var(--bg-sec); border: 1px solid var(--border);
            border-radius: 12px; color: var(--text); font-size: 1rem; margin-bottom: 20px; outline: none;
        }
        .provider-grid { display: grid; grid-template-columns: 1fr; gap: 10px; }
        .provider-card {
            padding: 16px; border: 1px solid var(--border); border-radius: 12px;
            display: flex; justify-content: space-between; align-items: center; cursor: pointer;
            transition: transform 0.1s, background 0.2s;
        }
        .provider-card:active { transform: scale(0.98); background: var(--bg-sec); }
        .arrow { color: var(--text-muted); }

        /* Tester Detail Overlay (Slide Up) */
        #tester-detail {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg); z-index: 100;
            transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            display: flex; flex-direction: column; padding: 20px;
        }
        #tester-detail.open { transform: translateY(0); }
        
        .detail-header { display: flex; align-items: center; margin-bottom: 40px; }
        .back-btn { background: none; border: none; font-size: 1.5rem; margin-right: 15px; cursor: pointer; color: var(--text); }
        
        .input-group { margin-bottom: 30px; position: relative; }
        .api-input {
            width: 100%; padding: 20px; font-size: 1.1rem; background: var(--bg-sec);
            border: 2px solid var(--border); border-radius: 16px; color: var(--text); outline: none;
            transition: border-color 0.3s;
        }
        .api-input:focus { border-color: var(--primary); }

        .status-container {
            display: flex; flex-direction: column; align-items: center; justify-content: center; margin-top: 20px;
        }
        .status-ring {
            width: 80px; height: 80px; border-radius: 50%; border: 6px solid var(--border);
            margin-bottom: 20px; display: flex; align-items: center; justify-content: center;
            font-size: 2rem; transition: all 0.4s; position: relative;
        }
        
        /* Status States */
        .status-ring.wait { border-color: var(--warning); animation: pulse 1.5s infinite; color: var(--warning); }
        .status-ring.error { border-color: var(--error); color: var(--error); animation: shake 0.4s; }
        .status-ring.success { border-color: var(--success); background: var(--success); color: white; box-shadow: 0 0 20px rgba(34, 197, 94, 0.4); }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }

        .action-btn {
            width: 100%; padding: 18px; background: var(--primary); color: var(--primary-fg);
            border: none; border-radius: 12px; font-size: 1rem; font-weight: 600; cursor: pointer;
            margin-top: auto; margin-bottom: 20px;
        }

        /* --- SANDBOX TAB (Grok Style) --- */
        #tab-sandbox { display: flex; flex-direction: column; padding: 0; }
        .chat-header {
            padding: 15px 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;
        }
        .model-badge { font-family: 'Courier New', monospace; font-size: 0.8rem; background: var(--bg-sec); padding: 4px 8px; border-radius: 4px; }
        
        .chat-area {
            flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px;
            scroll-behavior: smooth;
        }
        .message { max-width: 85%; line-height: 1.5; padding: 12px 16px; border-radius: 12px; font-size: 0.95rem; }
        .user-msg { align-self: flex-end; background: var(--bg-sec); color: var(--text); border-bottom-right-radius: 2px; }
        .ai-msg { align-self: flex-start; color: var(--text); padding-left: 0; font-family: 'Courier New', monospace; }
        .ai-msg strong { color: var(--text-muted); font-size: 0.8rem; display: block; margin-bottom: 4px; }

        .chat-input-area {
            padding: 15px; border-top: 1px solid var(--border); background: var(--bg);
            display: flex; gap: 10px;
        }
        .chat-input {
            flex: 1; background: transparent; border: none; outline: none;
            color: var(--text); font-size: 1rem; padding: 10px; font-family: 'Courier New', monospace;
        }
        .send-btn {
            background: var(--text); color: var(--bg); border: none; width: 40px; height: 40px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
        }

        /* --- SETTINGS TAB --- */
        .settings-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 0; border-bottom: 1px solid var(--border);
        }
        .toggle-switch {
            width: 50px; height: 28px; background: var(--border); border-radius: 14px;
            position: relative; cursor: pointer; transition: background 0.3s;
        }
        .toggle-switch::after {
            content: ''; position: absolute; top: 2px; left: 2px; width: 24px; height: 24px;
            background: white; border-radius: 50%; transition: transform 0.3s;
        }
        .toggle-switch.active { background: var(--success); }
        .toggle-switch.active::after { transform: translateX(22px); }

        /* --- BOTTOM NAV --- */
        .nav-bar {
            height: var(--nav-height); border-top: 1px solid var(--border);
            display: flex; background: var(--bg); z-index: 50;
        }
        .nav-item {
            flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: var(--text-muted); cursor: pointer; transition: color 0.2s;
        }
        .nav-item svg { width: 24px; height: 24px; margin-bottom: 4px; fill: currentColor; }
        .nav-item span { font-size: 0.75rem; font-weight: 500; }
        .nav-item.active { color: var(--primary); }

        .empty-state {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100%; color: var(--text-muted); text-align: center; padding: 40px;
        }
    </style>
</head>
<body>

    <!-- Splash Screen -->
    <div id="splash">
        <div class="wave-logo">WAVE STUDIO</div>
        <div class="wave-anim"></div>
    </div>

    <!-- App Content -->
    <div class="app-container">
        
        <!-- SECTION 1: TESTER -->
        <div id="section-tester" class="section active">
            <h1>API Tester</h1>
            <p>Select a provider to begin verification.</p>
            <input type="text" class="search-bar" id="providerSearch" placeholder="Search (e.g. OpenAI, Groq)...">
            <div class="provider-grid" id="providerList">
                <!-- Javascript will inject items here -->
            </div>
        </div>

        <!-- SECTION 1 OVERLAY: TESTER DETAIL -->
        <div id="tester-detail">
            <div class="detail-header">
                <button class="back-btn" onclick="closeDetail()">←</button>
                <h2 style="margin:0" id="detailTitle">Provider Name</h2>
            </div>

            <div style="flex: 1; display: flex; flex-direction: column; justify-content: center;">
                <p style="text-align: center;">Enter your API key below.</p>
                
                <div class="input-group">
                    <input type="password" class="api-input" id="apiKeyInput" placeholder="sk-...">
                </div>

                <div class="status-container">
                    <div class="status-ring" id="statusRing">
                        <span id="statusIcon">?</span>
                    </div>
                    <p id="statusText">Ready to test</p>
                </div>
            </div>

            <button class="action-btn" id="verifyBtn">VERIFY KEY</button>
        </div>

        <!-- SECTION 2: SANDBOX -->
        <div id="section-sandbox" class="section" style="padding:0;">
            <div class="chat-header">
                <span style="font-weight:700">SANDBOX_V1</span>
                <span class="model-badge" id="sandboxModel">NO_CONNECTION</span>
            </div>
            
            <div class="chat-area" id="chatArea">
                <div class="empty-state">
                    <h3>System Offline</h3>
                    <p>Please verify a valid API key in the Tester tab first to unlock the sandbox.</p>
                </div>
            </div>

            <div class="chat-input-area">
                <input type="text" class="chat-input" id="chatInput" placeholder="Enter message..." disabled>
                <button class="send-btn" id="sendMsgBtn" disabled>↑</button>
            </div>
        </div>

        <!-- SECTION 3: SETTINGS -->
        <div id="section-settings" class="section">
            <h1>Settings</h1>
            <p>Preferences & Info</p>

            <div class="settings-item">
                <span>Dark Mode</span>
                <div class="toggle-switch" id="themeToggle"></div>
            </div>

            <div class="settings-item">
                <div>
                    <span style="display:block; font-weight:600">Wave Studio</span>
                    <span style="font-size:0.8rem; color:var(--text-muted)">Version 2.0.1 (Build 84)</span>
                </div>
            </div>

            <div class="settings-item">
                <span style="color:var(--text-muted); font-size:0.8rem">
                    Designed for secure, client-side testing. Your keys are never stored on our servers.
                </span>
            </div>
        </div>

    </div>

    <!-- Bottom Navigation -->
    <nav class="nav-bar">
        <div class="nav-item active" onclick="switchTab('tester')">
            <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
            <span>Tester</span>
        </div>
        <div class="nav-item" onclick="switchTab('sandbox')">
            <svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/></svg>
            <span>Sandbox</span>
        </div>
        <div class="nav-item" onclick="switchTab('settings')">
            <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.04.24.24.41.48.41h3.84c.24 0 .43-.17.47-.41l.36-2.54c.59-.24 1.13-.57 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.08-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
            <span>Settings</span>
        </div>
    </nav>

    <script>
        // --- DATA ---
        const providers = [
            { id: 'openai', name: 'OpenAI', url: 'https://api.openai.com/v1/models', chat: 'https://api.openai.com/v1/chat/completions', model: 'gpt-4o-mini' },
            { id: 'anthropic', name: 'Anthropic', url: 'https://api.anthropic.com/v1/models', chat: 'https://api.anthropic.com/v1/messages', headers: {'anthropic-version': '2023-06-01'}, model: 'claude-3-5-sonnet-20240620' },
            { id: 'gemini', name: 'Google Gemini', url: 'https://generativelanguage.googleapis.com/v1beta/models?key={KEY}', chat: 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key={KEY}', model: 'gemini-1.5-flash', type: 'gemini' },
            { id: 'mistral', name: 'Mistral AI', url: 'https://api.mistral.ai/v1/models', chat: 'https://api.mistral.ai/v1/chat/completions', model: 'mistral-small-latest' },
            { id: 'groq', name: 'Groq', url: 'https://api.groq.com/openai/v1/models', chat: 'https://api.groq.com/openai/v1/chat/completions', model: 'llama3-8b-8192' },
            { id: 'deepseek', name: 'DeepSeek', url: 'https://api.deepseek.com/models', chat: 'https://api.deepseek.com/chat/completions', model: 'deepseek-chat' },
            { id: 'openrouter', name: 'OpenRouter', url: 'https://openrouter.ai/api/v1/auth/key', chat: 'https://openrouter.ai/api/v1/chat/completions', model: 'openai/gpt-3.5-turbo' },
            { id: 'together', name: 'Together AI', url: 'https://api.together.xyz/v1/models', chat: 'https://api.together.xyz/v1/chat/completions', model: 'meta-llama/Llama-3-8b-chat-hf' },
            { id: 'perplexity', name: 'Perplexity', url: 'https://api.perplexity.ai/models', chat: 'https://api.perplexity.ai/chat/completions', model: 'llama-3-sonnet-large-32k-online' }
        ];

        // --- STATE ---
        let activeKey = null;
        let activeProvider = null;

        // --- SPLASH SCREEN ---
        window.onload = () => {
            setTimeout(() => {
                document.getElementById('splash').style.opacity = '0';
                setTimeout(() => document.getElementById('splash').style.display = 'none', 600);
            }, 1500);
            renderProviders();
        };

        // --- NAVIGATION ---
        function switchTab(tabName) {
            // Update UI
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.getElementById(`section-${tabName}`).classList.add('active');
            
            // Update Nav Icons
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            // Find index and set active (simple matching)
            const navs = document.querySelectorAll('.nav-item');
            if(tabName === 'tester') navs[0].classList.add('active');
            if(tabName === 'sandbox') navs[1].classList.add('active');
            if(tabName === 'settings') navs[2].classList.add('active');
        }

        // --- TESTER LOGIC ---
        function renderProviders(filter = "") {
            const container = document.getElementById('providerList');
            container.innerHTML = '';
            providers.forEach(p => {
                if (p.name.toLowerCase().includes(filter.toLowerCase())) {
                    const card = document.createElement('div');
                    card.className = 'provider-card';
                    card.innerHTML = `<span>${p.name}</span><span class="arrow">→</span>`;
                    card.onclick = () => openDetail(p);
                    container.appendChild(card);
                }
            });
        }

        document.getElementById('providerSearch').addEventListener('input', (e) => renderProviders(e.target.value));

        // Detail View Logic
        const detailOverlay = document.getElementById('tester-detail');
        const apiInput = document.getElementById('apiKeyInput');
        const statusRing = document.getElementById('statusRing');
        const statusIcon = document.getElementById('statusIcon');
        const statusText = document.getElementById('statusText');
        const verifyBtn = document.getElementById('verifyBtn');

        let selectedProv = null;

        function openDetail(provider) {
            selectedProv = provider;
            document.getElementById('detailTitle').innerText = provider.name;
            detailOverlay.classList.add('open');
            // Reset Status
            resetStatus();
            apiInput.value = '';
        }

        function closeDetail() {
            detailOverlay.classList.remove('open');
        }

        function resetStatus() {
            statusRing.className = 'status-ring';
            statusIcon.innerText = '?';
            statusText.innerText = 'Ready to test';
            statusText.style.color = 'var(--text)';
            apiInput.disabled = false;
        }

        // Verification Logic
        verifyBtn.addEventListener('click', async () => {
            const key = apiInput.value.trim();
            if (!key) return;

            // Wait State (Orange)
            statusRing.className = 'status-ring wait';
            statusIcon.innerText = '•••';
            statusText.innerText = 'Connecting...';
            statusText.style.color = 'var(--warning)';
            apiInput.disabled = true;

            try {
                // Prepare Request
                let url = selectedProv.url.replace('{KEY}', key);
                let headers = { 'Content-Type': 'application/json' };
                
                // Header construction
                if (!selectedProv.url.includes('{KEY}')) {
                    headers['Authorization'] = `Bearer ${key}`;
                }
                if (selectedProv.headers) {
                    headers = { ...headers, ...selectedProv.headers };
                }

                // Proxy check (simple optional bypass)
                // In a real app, you'd want a robust proxy. This uses direct browser fetch.
                
                const response = await fetch(url, { method: 'GET', headers: headers });
                
                if (response.ok) {
                    // Success State (Green)
                    statusRing.className = 'status-ring success';
                    statusIcon.innerText = '✔';
                    statusText.innerText = 'Active & Secure';
                    statusText.style.color = 'var(--success)';
                    
                    // Enable Sandbox
                    activeKey = key;
                    activeProvider = selectedProv;
                    initSandbox();
                } else {
                    throw new Error(response.status);
                }
            } catch (e) {
                // Error State (Red)
                statusRing.className = 'status-ring error';
                statusIcon.innerText = '✖';
                statusText.innerText = 'Connection Failed';
                statusText.style.color = 'var(--error)';
                apiInput.disabled = false;
            }
        });

        // --- SANDBOX LOGIC ---
        function initSandbox() {
            const area = document.getElementById('chatArea');
            document.getElementById('sandboxModel').innerText = activeProvider.model;
            document.getElementById('chatInput').disabled = false;
            document.getElementById('sendMsgBtn').disabled = false;
            
            // Clear empty state
            area.innerHTML = `
                <div class="message ai-msg">
                    <strong>SYSTEM</strong>
                    Connection established to ${activeProvider.name}. Sandbox environment ready.
                </div>
            `;
        }

        document.getElementById('sendMsgBtn').addEventListener('click', sendMessage);
        
        async function sendMessage() {
            if (!activeKey) return;
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            if (!text) return;

            const area = document.getElementById('chatArea');
            
            // Render User Msg
            area.innerHTML += `<div class="message user-msg">${text}</div>`;
            input.value = '';
            area.scrollTop = area.scrollHeight;

            // Placeholder AI Msg
            const loadId = 'msg-' + Date.now();
            area.innerHTML += `<div class="message ai-msg" id="${loadId}"><strong>${activeProvider.name.toUpperCase()}</strong>...</div>`;
            area.scrollTop = area.scrollHeight;

            // API Call
            try {
                let url = activeProvider.chat.replace('{KEY}', activeKey);
                let headers = { 'Content-Type': 'application/json' };
                
                if (activeProvider.type !== 'gemini') {
                    headers['Authorization'] = `Bearer ${activeKey}`;
                }
                if (activeProvider.headers) {
                    headers = { ...headers, ...activeProvider.headers };
                    if(activeProvider.id === 'anthropic') headers['x-api-key'] = activeKey;
                }

                let body = {};
                
                // Payload formatting
                if (activeProvider.type === 'gemini') {
                    body = { contents: [{ parts: [{ text: text }] }] };
                } else if (activeProvider.id === 'anthropic') {
                    body = {
                        model: activeProvider.model,
                        messages: [{ role: "user", content: text }],
                        max_tokens: 200
                    };
                } else {
                    // OpenAI Standard
                    body = {
                        model: activeProvider.model,
                        messages: [{ role: "user", content: text }],
                        max_tokens: 150
                    };
                }

                const res = await fetch(url, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify(body)
                });
                const data = await res.json();
                
                let reply = "";
                if (activeProvider.type === 'gemini') reply = data.candidates[0].content.parts[0].text;
                else if (activeProvider.id === 'anthropic') reply = data.content[0].text;
                else reply = data.choices[0].message.content;

                document.getElementById(loadId).innerHTML = `<strong>${activeProvider.name.toUpperCase()}</strong>${reply}`;

            } catch (e) {
                document.getElementById(loadId).innerHTML = `<strong>ERROR</strong>${e.message}. Note: Browser CORS restrictions may block direct API calls.`;
            }
            area.scrollTop = area.scrollHeight;
        }

        // --- SETTINGS LOGIC ---
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', () => {
            themeToggle.classList.toggle('active');
            const isDark = themeToggle.classList.contains('active');
            document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
        });

    </script>
</body>
</html>